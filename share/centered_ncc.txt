Hi Mark,

The results are in. In the attached file, centered_ncc.zip, you will find a test script compare_ncc_methods.m that computes a cross-correlation for a single window of one of my test cases using a few different methods. There is also a .png image of the results, in case you can't run it for some reason.

The methods are:

- Mathworks CC: standard cross-correlation, xcorr2()

- Mathworks NCC: fast implementation of the standard normalized cross correlation, normxcorr2()

- Masked NCC: Padfield 2010 method, ignores all masked pixels

- Masked NCC, Weighted: Same as the above, except the result is weighted using
  the number of overlapping pixels. 

- Centered NCC, simple: Center sand pixels around zero, leave mask as zero, compute NCC. Centering is done once for the whole image.

- Centered NCC, complete: As above, except centering is done once per offset.

The test data are a single sample and interrogation window pair from a the lower boundary of a simple-shear test.

We can talk over the details, but the big takeaway is that both the centering and the Padfield boundary treatment provide a majot improvement to the correlation plane. Based on quality and speed, the best choices are the simple centering and the weighted masked NCC. I prefer the weighted masked NCC, because it has no edge artefacts and is fast enough to be useable.

The more important result is the wedge. These results are less enouraging. The wedge_test_* files show displacement and 2nd invariant strain (your Dd) for the standard NCC and the weighted masked NCC. I don't see a major change in the upper boundary.

--- Keith

